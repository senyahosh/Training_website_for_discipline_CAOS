<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CA&OS: Лабораторная работа №10</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/lab_code_style.css">
</head>
<body id="LitBG">
	<nav class="navbar navbar-expand-lg bg-dark navbar-dark fixed-top" data-bs-theme="dark">
		<div class="container-xxl">
			<a class="navbar-brand" href="/">CA&OS</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item">
						<a class="nav-link" href="/Lectures.html">Лекции</a>
					</li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="" role="button" data-bs-toggle="dropdown" aria-expanded="false">
							Задания
						</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="/Labs.html">Лабораторные работы</a></li>
							<li><a class="dropdown-item" href="/Tests.html">Тестирование</a></li>
							<li><a class="dropdown-item" href="/Indivs.html">Индивидуальные задания</a></li>
						</ul>
					</li>
					<li class="nav-item dropdown">
						<div class="btn-group">
							<a href="/Other.html" class="nav-link"> Прочее </a>
							<a class="nav-link dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
								<span class="visually-hidden">Toggle Dropdown</span>
							</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/Other.html#distributions">Дистрибутивы</a></li>
								<li><a class="dropdown-item" href="/Other.html#help">Справочная информация</a></li>
							</ul>
						</div>
					</li>
					<li class="nav-item">
						<a class="nav-link" href = "#contact">Контакты</a>
					</li>
				</ul>
				<form class="d-flex me-3" role="search">
					<input class="form-control me-1" type="search" placeholder="Поиск" aria-label="Search">
					<button class="btn btn-outline-light" type="submit">Поиск</button>
				</form>
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link" href="/Authorization.html">Авторизация</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<section>
		<div id="LiteraturePage" class="container-xxl">
			<div class="lec-container">	
				<h1 align="center"> Лабораторная работа №10. Создание процессов. </h1> 
				<h2 align="center"> Обязательные задания для решения в классе. </h2> 
				<hr style="border: 1px solid rgba(0, 0, 0, 0.6); margin: 30px 0px 20px;">
				<div class="container-xxl">
					<h5 class="clang-h4"> Указания к выполнению</h5>
					<ul>
						<li>Программ должна быть написана на языке С</li>
						<li>В программе должен создаваться минимум один новый процесс.</li>
						<li>Каждый процесс как родительский, так и дочерний должны выводить сообщение о том, что они начали работу и свой идентификатор.</li>
						<li>Родительский процесс должен ждать завершения дочернего процесса и выводить код его завершения.</li>
						<li>Дочерний процесс должен выполнять код согласно заданию.</li>
					</ul>
					<h4 class="clang-h4"> Вариант 1 </h4>
					<p class="clang-task">
						[<code>10_1.c</code>] Написать код, который выводит на экран числа от 1 до случайного числа в диапазоне [20, 200]. При этом вместо чисел, оканчивающихся на 3, программа должна выводить слово «<code>foo</code>», а вместо чисел, начинающихся с 2 — слово «<code>bar</code>». Если выполняются оба условия, программа должна выводить слово «<code>foo|bar</code>».
					</p> 			
					<h4 class="clang-h4"> Вариант 2 </h4>			
					<p class="clang-task">
						[<code>10_2.c</code>] Написать код, который будет выбирать 20 случайных лет в диапазоне от 1000 до 2100 и проверять каждый из них на високосность (должен или делиться на 400, или делиться на 4, но не делиться на 100). Необходимо на отдельной строке вывести год и результат проверки.
					</p>
					<h4 class="clang-h4"> Вариант 3 </h4>
					<p class="clang-task">
						[<code>10_3.c</code>] Написать код, который выбирает случайное четырёхзначное число (от 1000 до 9999) и спрашивает у пользователя его вариант четырёхзначного числа. Затем сценарий должен вывести количество десятичных позиций (от 0 до 3), которые в обоих числах совпадают. После этого сценарий должен вывести выбранное им число для проверки.
					</p> 
					<h4 class="clang-h4"> Вариант 4 </h4>			
					<p class="clang-task">
						[<code>10_4.c</code>] Написать код, который выбирает случайное четырёхзначное число и проверяет его на простоту. Необходимо вывести это число и результат проверки.
					</p>
					<h4 class="clang-h4"> Вариант 5 </h4>
					<p class="clang-task">
						[<code>10_5.c</code>] Написать код, который вводит из стандартного потока два числа и находит их наибольший общий делитель.
					</p>
					<h4 class="clang-h4"> Вариант 6 </h4>
					<p class="clang-task">
						[<code>10_6.c</code>] Написать код, который вводит из стандартного потока число и находит сумму цифр его десятичного представления.
					</p> 
					<h4 class="clang-h4"> Вариант 7 </h4>			
					<p class="clang-task">
						[<code>10_7.c</code>] Написать код, который вводит из стандартного потока число и определяет, состоит ли его десятичное представление из одинаковых цифр (кроме возможных ведущих нулей).
					</p>
					<h4 class="clang-h4"> Вариант 8 </h4>
					<p class="clang-task">
						[<code>10_8.c</code>] Написать код, который вводит из стандартного потока число <code>n</code> и выводит последовательность <code>n</code> первых чисел Фибоначчи.
					</p> 
					<h4 class="clang-h4"> Вариант 9 </h4>			
					<p class="clang-task">
						[<code>10_9.c</code>] Написать код, который вводит из стандартного потока число и увеличивает каждый из его разрядов на 1 (если в разряде находится цифра 9, она должна быть заменена на 0). Полученный результат должен быть выведен в стандартный поток.
					</p>
					<h4 class="clang-h4"> Вариант 10 </h4>
					<p class="clang-task">
						[<code>10_a.c</code>] Написать код, который вводит из стандартного потока координаты клетки шахматной доски и выводит её цвет. Вводимые координаты должны проверяться на корректность.
					</p> 
					<h4 class="clang-h4"> Вариант 11 </h4>			
					<p class="clang-task">
						[<code>10_b.c</code>] Написать код, который вводит из стандартного потока число и получает из него другое число при помощи записи его десятичных разрядов в обратном порядке. Полученный результат должен быть выведен в стандартный поток.
					</p>
					<h4 class="clang-h4"> Вариант 12 </h4>
					<p class="clang-task">
						[<code>10_c.c</code>] Написать код, который вводит из стандартного потока число и находит его факториал. Полученный результат должен быть выведен в стандартный поток.
					</p> 
					<h4 class="clang-h4"> Вариант 13 </h4>			
					<p class="clang-task">
						[<code>10_d.c</code>] Написать код, который выбирает случайное пятизначное число и проверяет его на простоту. Необходимо вывести это число и результат проверки.
					</p>
					<h4 class="clang-h4"> Вариант 14 </h4>
					<p class="clang-task">
						[<code>10_e.c</code>] Написать код, который вводит из стандартного потока число и находит его двойной факториал. Полученный результат должен быть выведен в стандартный поток.
					</p> 
					<h4 class="clang-h4"> Вариант 15 </h4>			
					<p class="clang-task">
						[<code>10_f.c</code>] Написать код, который будет выбирать 30 случайных лет в диапазоне от 300 до 2100 и проверять каждый из них на невисокосность (високосный год должен или делиться на 400, или делиться на 4, но не делиться на 100). Необходимо на отдельной строке вывести год и результат проверки.
					</p>

					<form id="uploadForm" enctype="multipart/form-data">
						<input type="file" name="file" id="fileInput" class="fileloader">
						<button type="submit" class="btn btn-primary" id="load"> Сдать задание </button>
					</form>

					<div id="container">
						<div id="reveal-modal">
							<div id=text>
								<pre></pre>
							</div>
							<button class="btn" id="close"> Закрыть </button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<footer class="footer-dark bg-dark">
		<p><a name="contact"></a></p>
		<div class="container-xxl">
			<div class="row align-items-center">
				<div class="col-5">
					<ul class="list-group list-group-flush">
						<li class="list-group-item bg-dark text-light"> Руководитель курса: доц. к. ф.-м. н. Андреева Евгения Михайловна <br> Кафедра информатики и вычислительного эксперимента </li>
						<li class="list-group-item bg-dark text-light"> Адрес: г. Ростов-на-Дону, ул. Мильчакова 8А, ауд. 203</li>
						<li class="list-group-item bg-dark text-light">
							Телефон:
							<ol class="list-group list-group-numbered">
								<li class="bg-dark text-light"> +7(863) 218-40-00 доб. 11062 </li>
								<li class="bg-dark text-light"> +7(863) 468-08-90 доб. 11062 </li>
							</ol>
						</li>
						<li class="list-group-item bg-dark text-light"> Корпоративная почта: 
							<a href="#contact" class="link-primary"> andreeva@sfedu.ru </a> 
						</li>
						<li class="list-group-item bg-dark text-light"> Персональная страница: <a href="https://sfedu.ru/person/andreeva" class="link-primary"> https://sfedu.ru/person/andreeva </a></li>
					</ul>
				</div>
				<div class="col-2"> </div>
				<div class="col-5">
    				<form>
						<div id="InputForm">
							<input required type="email" class="form-control" placeholder="example@sfedu.ru">
						</div>
						<div id="InputForm">
							<textarea required type="text" class="form-control" placeholder="Введите сообщение" rows = "4"></textarea>
						</div>
						<button class="btn btn-block btn-md btn-outline-light" type="button"> Отправить </button>
					</form>
    			</div>
			</div>
		</div>
		<hr id="mainhr">
		<div class="text-center bg-dark" style="color: rgba(255, 255, 255, 0.5);"> &copy 2023-2024 </div>
	</footer>

	<script>
		// Запуск докер-контейнера для компилятора и cppcheck
		function runCommands(fileName) {

			const filename = fileName;
			const commands = [
				'docker build --build-arg C_FILE=' + filename + ' -t c-compiler C:\\Users\\111\\MySite\\uploads\\.',
				'docker run -v C:\\Users\\111\\MySite\\uploads\\' + filename + ':/code cppcheck-image cppcheck --quiet --enable=all --std=c11 --language=c /code'
			];

			const testFiles = [
				'C:/Users/111/MySite/progTests/10_6_test1.txt',
				'C:/Users/111/MySite/progTests/10_6_test2.txt',
				'C:/Users/111/MySite/progTests/10_6_test3.txt',
				'C:/Users/111/MySite/progTests/10_6_test4.txt'
			];

			const dataToSend = {
				commands: commands,
				testFiles: testFiles
			};

			const socket = new WebSocket('ws://localhost:8080');

			socket.onopen = () => {
				socket.send(JSON.stringify(dataToSend));
			};

			socket.onmessage = (event) => {
				showOutput(event.data);
			};

			socket.onerror = (error) => {
				console.error('WebSocket error:', error);
			};
		}

		// Всплывающее окно с ошибками	
		const modal = document.querySelector('#container');
		const close = document.querySelector('#close');

		function showOutput(output) {
        	var text = document.getElementById("text");
			var newNode = document.createElement("pre");
			var oldNode = text.firstElementChild;
			newNode.textContent = output;
			text.replaceChild(newNode, oldNode);

			modal.style.display = 'block';
			modal.style.visibility = 'visible';
        }

        close.onclick = function () {
			modal.style.display = 'none';
		};

		document.addEventListener('keydown', function(e) {
			if (e.keyCode == 27) {
				modal.style.display = 'none';
			}
		});

		// Загрузка файла
        const uploadForm = document.getElementById('uploadForm');
    	uploadForm.addEventListener('submit', async (e) => {
    		e.preventDefault();

    		const formData = new FormData();
    		const fileInput = document.getElementById('fileInput');

    		if (fileInput.files && fileInput.files.length == 1) {
    			formData.append('file', fileInput.files[0]);
    			var filename = fileInput.files[0].name;

    			try {
	    			const response = await fetch('http://localhost:8000/upload', {
	    				method: 'POST',
	    				body: formData
	    			});

	    			if (response.ok) {

	    				console.log('File uploaded successfully!');
	    				alert('Файл успешно загружен!\nЗакройте это сообщение, чтобы посмотреть отчёт о проверке.\n\nВнимание! Это может занять некоторое время.');
	    				
	    				runCommands(filename);
	    			
	    			} else {
	    				console.error('Failed to upload file');
	    				alert('Ошибка при загрузке файла.')
	    			}

	    			uploadForm.reset();

	    		} catch (error) {
	    			console.error(error);
	    		}
    		}
    		else {
    			alert('Файл не прикреплен.');
    		}
    	});

	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>